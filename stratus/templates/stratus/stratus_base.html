{% extends "admin/base_site.html" %}

{% block breadcrumbs %}
<div class="breadcrumbs">
	<ul>
		<li><a href="{% url stratus-repos %}" >projects</a></li>
		{% if repo_name %}
		<li class="project">{{ repo_name }}</li>
		{% endif %}
		{% if repo_name and branch_name %}
		<li>"<a class="ajax" rel="contents" href="{% url stratus-log repo_name branch_name %}" title="Commits at {{branch_name}} branch" >{{ branch_name }}</a>" branch</li>	
		{% endif %}

{% block git_breadcrumbs %}{% endblock git_breadcrumbs %}
	</ul>
</div>


{% if repo_name and branch_name %}
<div id="project_tools">
	<form method="get" action="{% url stratus-search repo_name branch_name %}" class="serch_form ajax" rel="contents">
		<p>
			<input type="text" name="query" id="id_query" value="{{ query }}" /> 
			<button>SEARCH</button>
			{% csrf_token %}
		</p>
	</form>
	<a href="{% url stratus-undo repo_name branch_name %}" class="undo button ajax" rel="#tool_box" title="undo last commit">undo</a>
	<a href="https://github.com/joyent/node/wiki/modules" id="open_preview" title="open preview" class="button">preview</a>
</div>
{% endif %}


{% endblock breadcrumbs %}



{% block content %}
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.15/jquery-ui.min.js"></script>
<script type="text/javascript" src="{{ STRATUS_MEDIA_URL }}stratus/js/fileuploader.js" charset="utf-8"></script>
<script type="text/javascript" src="{{ STRATUS_MEDIA_URL }}stratus/CodeMirror-2.12/lib/codemirror.js"></script>
<script type="text/javascript" src="{{ STRATUS_MEDIA_URL }}stratus/CodeMirror-2.12/lib/overlay.js"></script>
<!-- <script type="text/javascript" src="{{ STRATUS_MEDIA_URL }}stratus/CodeMirror-2.12/mode/python/python.js"></script> -->
<script type="text/javascript" src="{{ STRATUS_MEDIA_URL }}stratus/CodeMirror-2.12/mode/diff/diff.js"></script>
<script type="text/javascript" src="{{ STRATUS_MEDIA_URL }}stratus/js/script.js"></script>

<link rel="stylesheet" type="text/css" href="{{ STRATUS_MEDIA_URL }}stratus/css/theme_dark.css" />
<link rel="stylesheet" type="text/css" href="{{ STRATUS_MEDIA_URL }}stratus/css/style.css" />
<link rel="stylesheet" type="text/css" href="{{ STRATUS_MEDIA_URL }}stratus/CodeMirror-2.12/lib/codemirror.css" /> 


<div class="gitter">
	<div id="messages" {% if not msg %} style="display: none;" {% endif %}>
		<a href="#" class="close" title="close">x</a>
		<ul>
		{% for message in msg %}
			<li>{{ message }}</li>
		{% endfor %}
		</ul>
	</div>
{% if branch_name %}

	<p><a href="#" id="toogle_files" class="toggle" rel="#browser">Files:</a></p>
	<div id="browser">
		<div id="file_browser" >
{% block git_tree %}{% endblock git_tree %}
		</div>
		<p class="new_file">NEW FILE</p>
		<form enctype="multipart/form-data" action="{% url stratus-upload-file repo_name branch_name %}" method="post" >
			<input type="hidden" value="" name="upload_dir" id="id_upload_dir" />
			{% csrf_token %}
			<div class="qq-uploader">
				<div class="qq-upload-drop-area" style="display: none; ">
					<span>Drop files here to upload</span>
				</div>
				<div id="id_file_upload">      
				    <noscript><p>Please enable JavaScript to use file uploader.</p></noscript>         
				</div>
			</div>
		</form>
		<div id="new_file">
			<input type="text" id="new_file_name">
			<button id="create_new_file">+</button>
		</div>

	</div>
{% endif %}
	<div id="toolbox">
	</div>

	<div id="console">
		<h4>Console</h4>
		<div class="content">
			<div id="console_output"></div>
			<p>
				<label for="console-input">Command</label>
				<input id="console-input" type="text" />
				<button id="console_enter">ENTER</button>
			</p>
		</div>
	</div>
	
	<div id="main">
		<ul class="tabs"></ul>
		<div id="pages">
			<div class="page">
{% block git_content %}{% endblock git_content %}
			</div><!-- /.page -->
		</div><!-- /.pages -->
	</div><!-- /main -->
</div> <!-- /.gitter -->





{% if repo_name and branch_name %}
<script type="text/javascript">
var REPO = "{{repo_name}}";
var BRANCH = "{{ branch_name }}";
var PATH = "{{path}}";
var STRATUS_MEDIA_URL = "{{ STRATUS_MEDIA_URL }}";
var CONSOLE_URL = "{% url stratus-consol repo_name %}";

{% if repo_name and branch_name %}
var UPLOAD_URL = "{% url stratus-upload-file repo_name branch_name %}";
var NEW_FILE_URL = "{% url stratus-new-file repo_name branch_name '' %}";
{% endif %}

// ----------------- TREE INIT --------------------
var tree_path =  {% if path %} '{% url stratus-tree-view repo_name branch_name path %}'
{% else %} '{% url stratus-tree-view repo_name branch_name "" %}' {% endif %};
</script>
{% endif %}	

{% block js %}{% endblock js %}

<script type="text/template" id="url_template">
<div class="page">
<p>
	<input type="text" name="src" value="sssss" >
	<button class="go">GO</button>
</p>
<iframe src="sssss"></iframe>
</div>
</script>


{% endblock content %}